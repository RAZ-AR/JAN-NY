# Структура проекта

## Обзор

```
ny-sets-miniapp/
├── public/                 # Статические файлы
├── src/
│   ├── components/        # React компоненты
│   │   ├── UserInfoStep.jsx         # Шаг 1: Контактные данные
│   │   ├── UserInfoStep.css
│   │   ├── SetsSelectionStep.jsx    # Шаг 2: Выбор сетов
│   │   ├── SetsSelectionStep.css
│   │   ├── DeliverySlotStep.jsx     # Шаг 3: Время доставки
│   │   ├── DeliverySlotStep.css
│   │   ├── AddressStep.jsx          # Шаг 4: Адрес
│   │   ├── AddressStep.css
│   │   ├── PaymentStep.jsx          # Шаг 5: Оплата
│   │   ├── PaymentStep.css
│   │   ├── ConfirmationStep.jsx     # Шаг 6: Подтверждение
│   │   ├── ConfirmationStep.css
│   │   ├── SuccessStep.jsx          # Шаг 7: Успех
│   │   └── SuccessStep.css
│   ├── data/
│   │   └── sets.js        # Данные о сетах, слотах, оплате
│   ├── App.jsx            # Главный компонент приложения
│   ├── App.css            # Общие стили и градиенты
│   ├── main.jsx           # Точка входа React
│   └── index.css          # Глобальные стили
├── bot-example.js         # Пример Telegram бота
├── bot-package.json       # Зависимости для бота
├── .env.example           # Пример переменных окружения
├── index.html             # HTML шаблон
├── vite.config.js         # Конфигурация Vite
├── package.json           # Зависимости проекта
├── README.md              # Основная документация
├── TELEGRAM_BOT_SETUP.md  # Настройка бота
├── DEPLOYMENT.md          # Инструкции по деплою
└── PROJECT_STRUCTURE.md   # Этот файл
```

## Описание компонентов

### App.jsx
Главный компонент приложения, управляет:
- Пошаговой навигацией (7 шагов)
- Состоянием заказа
- Интеграцией с Telegram WebApp API
- Отправкой данных боту

### Компоненты шагов

#### 1. UserInfoStep
- Сбор имени и телефона
- Валидация обязательных полей
- Переход на следующий шаг

#### 2. SetsSelectionStep
- Отображение 3 сетов
- Показ состава каждого сета
- Счетчики количества (+/-)
- Подсчет общей стоимости
- Проверка выбора хотя бы одного сета

#### 3. DeliverySlotStep
- Выбор часового слота доставки
- 4 варианта: 18:00-22:00
- Визуальная индикация выбранного слота

#### 4. AddressStep
- Ввод улицы (обязательно)
- Ввод дома (обязательно)
- Ввод квартиры (опционально)
- Комментарий к адресу (опционально)

#### 5. PaymentStep
- Выбор способа оплаты (наличные/безнал)
- Поле для сдачи (только для наличных)
- Иконки для визуального различия

#### 6. ConfirmationStep
- Просмотр всех данных заказа
- Поле для промокода (без валидации)
- Поле для пожеланий
- Кнопка финальной отправки

#### 7. SuccessStep
- Подтверждение успешного заказа
- Отображение номера заказа
- Праздничные элементы

## Данные (data/sets.js)

### sets
Массив из 3 сетов с информацией:
- id, name, price, weight, people
- items[] - состав сета

### deliverySlots
4 временных слота с id и временем

### paymentMethods
2 способа оплаты (cash, card)

## Стили

### App.css
- Градиентный анимированный фон
- Общие стили для форм и кнопок
- Индикатор прогресса
- Анимации переходов

### Компонентные CSS
Каждый компонент имеет свой CSS файл со специфичными стилями:
- Карточки сетов
- Кнопки выбора
- Формы ввода
- Элементы подтверждения

## Поток данных

```
User Input → Component State → App State → Confirmation → Telegram Bot API
```

1. Пользователь вводит данные на шаге
2. Компонент валидирует и сохраняет в локальном state
3. При нажатии "Далее" данные передаются в App.jsx
4. App.jsx сохраняет в общий orderData
5. На последнем шаге все данные отправляются боту

## Telegram WebApp API

### Инициализация
```javascript
window.Telegram.WebApp.ready()
window.Telegram.WebApp.expand()
```

### Отправка данных
```javascript
window.Telegram.WebApp.sendData(JSON.stringify(orderData))
```

### Настройка темы
```javascript
tg.setHeaderColor('#1a1a1a')
tg.setBackgroundColor('#0a0a0a')
```

## Состояние приложения

```javascript
{
  currentStep: 1-7,
  orderData: {
    userInfo: { name, phone },
    selectedSets: { setId: quantity },
    deliverySlot: slotId,
    address: { street, house, apartment, note },
    payment: { method, changeFrom },
    promoCode: string,
    wishes: string
  },
  orderNumber: 'NYXXXXXX'
}
```

## Навигация

- Шаги 1: только "Далее"
- Шаги 2-6: "Назад" и "Далее"
- Шаг 7: только просмотр

При нажатии "Назад" сохраняются введенные данные.

## Валидация

### Обязательные поля:
- Шаг 1: имя, телефон
- Шаг 2: хотя бы 1 сет
- Шаг 3: слот доставки
- Шаг 4: улица, дом
- Шаг 5: способ оплаты

### Необязательные поля:
- Квартира
- Комментарий к адресу
- Сдача (для наличных)
- Промокод
- Пожелания

## Telegram Bot

### Получение данных
Бот получает данные через событие `web_app_data`

### Формат данных
JSON объект со всей информацией о заказе

### Обработка
- Форматирование красивого сообщения
- Отправка админу
- Подтверждение клиенту

## Расширение функционала

### Добавление нового сета
1. Добавьте данные в `src/data/sets.js`
2. Обновите `SET_NAMES` и `SET_PRICES` в боте
3. Протестируйте

### Добавление нового шага
1. Создайте компонент `NewStep.jsx` и `NewStep.css`
2. Добавьте в imports в `App.jsx`
3. Добавьте case в `renderStep()`
4. Добавьте handler в `App.jsx`
5. Обновите индикатор прогресса

### Интеграция с базой данных
1. Создайте API endpoint для сохранения заказов
2. В `App.jsx` замените `sendData()` на API call
3. Обновите бота для работы с БД

### Добавление аналитики
1. Установите аналитический сервис
2. Отслеживайте events на каждом шаге
3. Анализируйте конверсию

## Производительность

### Оптимизации:
- React.memo для компонентов
- Lazy loading для шагов
- Минификация CSS
- Code splitting
- Image optimization

### Размер бандла:
- ~100-150 KB после gzip
- Быстрая загрузка даже на 3G

## Безопасность

- Валидация данных на клиенте
- Валидация данных в боте
- Санитизация input полей
- HTTPS обязателен
- Аутентификация через Telegram
